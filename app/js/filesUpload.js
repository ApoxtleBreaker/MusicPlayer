SVGFullScreen = '<svg t="1734834700766" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1451" width="200" height="200"><path d="M41.909959 682.266194h0.1397a41.909959 41.909959 0 0 1 41.909959 41.909959V975.105048a41.909959 41.909959 0 0 1-41.909959 41.909959H41.909959a41.909959 41.909959 0 0 1-41.909959-41.909959V724.176153a41.909959 41.909959 0 0 1 41.909959-41.909959z" p-id="1452"></path><path d="M43.306958 933.320819h252.088404a41.909959 41.909959 0 0 1 41.909959 41.909959 41.909959 41.909959 0 0 1-41.909959 41.909959H43.306958a41.909959 41.909959 0 0 1-41.909959-41.909959 41.909959 41.909959 0 0 1 41.909959-41.909959z" p-id="1453"></path><path d="M13.495007 1002.905321a41.742319 41.742319 0 0 1 0.963929-59.162893l341.845566-329.817408a41.909959 41.909959 0 1 1 58.394543 60.070942L72.853479 1003.86925a42.077599 42.077599 0 0 1-59.358472-0.963929zM981.964311 5.587995h0.12573a41.909959 41.909959 0 0 1 41.909959 41.909959v250.942865a41.909959 41.909959 0 0 1-41.909959 41.909959h-0.12573a41.909959 41.909959 0 0 1-41.909959-41.909959V47.497954a41.909959 41.909959 0 0 1 41.909959-41.909959z" p-id="1454"></path><path d="M728.604638 5.587995H980.693042a41.909959 41.909959 0 0 1 41.909959 41.909959 41.909959 41.909959 0 0 1-41.909959 41.909959H728.604638a41.909959 41.909959 0 0 1-41.909959-41.909959 41.909959 41.909959 0 0 1 41.909959-41.909959z" p-id="1455"></path><path d="M1010.504993 19.697681a41.742319 41.742319 0 0 1-0.963929 59.162892l-341.845566 329.831378a41.909959 41.909959 0 1 1-58.394543-60.070941l341.845566-329.817408a42.077599 42.077599 0 0 1 59.358472 0.894079zM48.894952 0h250.928895a41.909959 41.909959 0 0 1 41.909959 41.909959v0.12573a41.909959 41.909959 0 0 1-41.909959 41.909959H48.894952a41.909959 41.909959 0 0 1-41.909959-41.909959V41.909959A41.909959 41.909959 0 0 1 48.894952 0z" p-id="1456"></path><path d="M48.894952 1.396999a41.909959 41.909959 0 0 1 41.909959 41.909959v252.158253a41.909959 41.909959 0 0 1-41.909959 41.90996 41.909959 41.909959 0 0 1-41.909959-41.90996V43.306958A41.909959 41.909959 0 0 1 48.894952 1.396999z" p-id="1457"></path><path d="M21.094679 13.495007a41.742319 41.742319 0 0 1 59.162893 0.963929l329.817408 341.845566a41.909959 41.909959 0 1 1-60.070942 58.394543L20.13075 72.853479a42.077599 42.077599 0 0 1 0.963929-59.358472zM725.559181 940.054352H976.502046a41.909959 41.909959 0 0 1 41.909959 41.909959v0.12573a41.909959 41.909959 0 0 1-41.909959 41.909959H725.559181a41.909959 41.909959 0 0 1-41.909959-41.909959v-0.12573a41.909959 41.909959 0 0 1 41.909959-41.909959z" p-id="1458"></path><path d="M976.502046 686.750559a41.909959 41.909959 0 0 1 41.909959 41.909959V980.693042a41.909959 41.909959 0 0 1-41.909959 41.909959 41.909959 41.909959 0 0 1-41.909959-41.909959V728.604638a41.909959 41.909959 0 0 1 41.909959-41.854079z" p-id="1459"></path><path d="M1004.302319 1010.504993a41.742319 41.742319 0 0 1-59.162892-0.963929l-329.831378-341.845566a41.909959 41.909959 0 1 1 60.070941-58.394543l329.817408 341.845566a42.077599 42.077599 0 0 1-0.894079 59.358472z" p-id="1460"></path></svg>'
SVGDisFullScreen = '<svg t="1734835435255" class="icon" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1522" width="200" height="200"><path d="M385.690843 601.953608h0.125507a41.835647 41.835647 0 0 1 41.835648 41.835647v250.483966a41.835647 41.835647 0 0 1-41.835648 41.835648h-0.125507a41.835647 41.835647 0 0 1-41.835647-41.835648V643.789255a41.835647 41.835647 0 0 1 41.835647-41.835647z" p-id="1523"></path><path d="M132.822245 601.953608h251.599584a41.835647 41.835647 0 1 1 0 83.545788H132.822245a41.835647 41.835647 0 0 1 0-83.545788z" p-id="1524"></path><path d="M414.180919 616.038276a41.68225 41.68225 0 0 1-0.96222 59.057989L72.048995 1004.34281a41.835647 41.835647 0 1 1-58.277057-59.964428l341.169704-329.302326a41.989045 41.989045 0 0 1 59.239277 0.96222zM638.224756 86.510541h0.139453a41.835647 41.835647 0 0 1 41.835647 41.835647V378.830155a41.835647 41.835647 0 0 1-41.835647 41.835647h-0.139453a41.835647 41.835647 0 0 1-41.835647-41.835647V128.346188a41.835647 41.835647 0 0 1 41.835647-41.835647z" p-id="1525"></path><path d="M639.619278 337.120014h251.641419a41.835647 41.835647 0 0 1 41.835648 41.835648 41.835647 41.835647 0 0 1-41.835648 41.835647H639.619278a41.835647 41.835647 0 0 1-41.835647-41.835647 41.835647 41.835647 0 0 1 41.835647-41.835648z" p-id="1526"></path><path d="M609.860187 406.581134a41.668305 41.668305 0 0 1 0.96222-59.057989l341.239431-329.2326a41.835647 41.835647 0 1 1 58.291002 59.964428l-341.239431 329.288381a42.00299 42.00299 0 0 1-59.253222-0.96222zM129.740352 343.813718h250.497912a41.835647 41.835647 0 0 1 41.835647 41.835647v0.139452a41.835647 41.835647 0 0 1-41.835647 41.835648H129.740352a41.835647 41.835647 0 0 1-41.835647-41.835648v-0.139452a41.835647 41.835647 0 0 1 41.835647-41.835647z" p-id="1527"></path><path d="M380.238264 91.0009a41.835647 41.835647 0 0 1 41.835647 41.835648V384.408241a41.835647 41.835647 0 0 1-41.835647 41.835647 41.835647 41.835647 0 0 1-41.835647-41.835647V132.766822a41.835647 41.835647 0 0 1 41.835647-41.765922z" p-id="1528"></path><path d="M407.989243 414.139441a41.68225 41.68225 0 0 1-59.057989-0.96222L19.684709 71.951735a41.835647 41.835647 0 1 1 59.964428-58.291002l329.302326 341.239431a41.989045 41.989045 0 0 1-0.96222 59.239277zM645.197364 596.375521h250.483967a41.835647 41.835647 0 0 1 41.835647 41.835648v0.139452a41.835647 41.835647 0 0 1-41.835647 41.835647H645.197364a41.835647 41.835647 0 0 1-41.835647-41.835647v-0.139452a41.835647 41.835647 0 0 1 41.835647-41.835648z" p-id="1529"></path><path d="M645.197364 597.770043a41.835647 41.835647 0 0 1 41.835648 41.835647v251.64142a41.835647 41.835647 0 0 1-41.835648 41.835647 41.835647 41.835647 0 0 1-41.835647-41.835647V639.522019a41.835647 41.835647 0 0 1 41.835647-41.751976z" p-id="1530"></path><path d="M617.446385 609.832655a41.668305 41.668305 0 0 1 59.057989 0.962219l329.246545 341.253377a41.835647 41.835647 0 1 1-59.964428 58.291002L616.484165 669.085877a42.00299 42.00299 0 0 1 0.96222-59.253222z" p-id="1531"></path></svg>'
SVGCancle = '<svg t="1734835550036" class="icon" viewBox="0 0 1125 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1677" width="200" height="200"><path d="M1106.502396 14.490759a56.428057 56.428057 0 0 1 0 83.888678l-1012.311168 911.12934a56.428057 56.428057 0 0 1-75.509668 0 56.428057 56.428057 0 0 1 0-83.888679l1012.311168-911.129339a56.428057 56.428057 0 0 1 75.509668 0z" p-id="1678"></path><path d="M94.191228 14.490759l1012.311168 911.129339a56.428057 56.428057 0 0 1 0 83.888679 56.428057 56.428057 0 0 1-75.509668 0l-1012.311168-911.12934a56.428057 56.428057 0 0 1 0-83.888678 56.428057 56.428057 0 0 1 75.509668 0z" p-id="1679"></path></svg>'
SVGAddFile= '<svg t="1734836174303" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4282" width="200" height="200"><path d="M960.2 420.7V279.8c0-19.9-16.1-36-36-36H590L472.3 136.9c-6.6-6-15.2-9.3-24.2-9.3H100.3c-19.9 0-36 16.1-36 36v259c-0.1 1-0.1 2.1-0.1 3.2v433.9c0 9.6 3.8 18.8 10.6 25.5 6.7 6.7 15.9 10.5 25.4 10.5h0.2l824.1-4c19.8-0.1 35.8-16.2 35.8-36V421.8c-0.1-0.4-0.1-0.7-0.1-1.1z m-72 399.1l-752.1 3.7V429c0.1-1 0.1-2.1 0.1-3.2V199.6h297.9l117.7 106.8c6.6 6 15.2 9.3 24.2 9.3h312.1v504.1z" fill="#ffffff" p-id="4283"></path><path d="M648.4 515.5H549V416c0-19.9-16.1-36-36-36s-36 16.1-36 36v99.4h-99.4c-19.9 0-36 16.1-36 36s16.1 36 36 36H477v99.4c0 19.9 16.1 36 36 36s36-16.1 36-36v-99.4h99.4c19.9 0 36-16.1 36-36s-16.1-35.9-36-35.9z" fill="#ffffff" p-id="4284"></path></svg>'
SVGOK = '<svg t="1734836266245" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8217" width="200" height="200"><path d="M456.899566 728.522382c-15.978926 15.977903-40.33873 18.47477-58.932204 7.492648-3.446495-2.039449-9.653871-9.990538-9.653871-9.990538L188.797435 526.509459c-18.938328-18.938328-18.938328-47.148833 0-66.084091 18.934235-18.938328 49.64263-16.442484 68.579935 2.495844l165.227112 165.225065 312.24449-312.24142c18.938328-18.938328 49.6457-21.435195 68.583005-2.495844 18.938328 18.940374 18.939351 47.149856 0 66.085114L456.909799 728.507032c0 0-0.005117 0.00921-0.010233 0.013303l0 0L456.899566 728.522382zM510.742868 64.090691c-246.752894 0-446.786743 200.032826-446.786743 446.786743 0 246.75187 200.033849 446.785719 446.786743 446.785719 246.752894 0 446.787766-200.034872 446.787766-446.785719C957.531658 264.125563 757.495762 64.090691 510.742868 64.090691L510.742868 64.090691 510.742868 64.090691 510.742868 64.090691z" fill="#272636" p-id="8218"></path></svg>'
SVGMusic = '<svg t="1734836383109" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12442" width="200" height="200"><path d="M955.027253 38.540704c0-10.145037-4.876044-19.627997-13.07578-25.58772-8.228389-5.94642-18.767398-7.551985-28.404877-4.410441L373.710677 186.442947c-12.878283 4.212943-21.61423 16.23165-21.698142 29.800663l-2.776224 497.262374c-29.630795-24.474365-67.590263-39.184363-108.929703-39.184363-94.486789 0-171.333861 76.875725-171.333861 171.348188 0 94.486789 76.847072 171.362513 171.333861 171.362513 94.346596 0 171.151713-76.720182 171.320558-171.051429l0.027629-0.155542 2.818179-504.124651 310.041716-101.969189c11.046568-3.634776 17.04927-15.526594 13.413471-26.573163-3.607147-11.060895-15.470312-17.04927-26.574186-13.442123l-296.643594 97.600703 0.338714-58.022368L891.848455 82.190766v57.853524l-79.412495 26.137235c-11.046568 3.6358-17.04927 15.54092-13.412448 26.601814 2.902091 8.848511 11.130479 14.456218 20.00662 14.456218a21.284726 21.284726 0 0 0 6.566542-1.042747l66.251781-21.825031v372.637231c-29.505952-24.108023-67.153312-38.620522-108.155063-38.620522-94.486789 0-171.362513 76.874701-171.362513 171.36149 0 94.460183 76.875725 171.334884 171.362513 171.334884 94.487812 0 171.334884-76.874701 171.334885-171.334884 0-4.648871-0.338714-9.171875-0.705057-13.694879a31.640564 31.640564 0 0 0 0.705057-6.56552V38.540704h-0.001024zM240.305584 953.866827c-59.656586 0-108.182692-48.568062-108.182692-108.197018 0-59.656586 48.526106-108.182692 108.182692-108.182692 59.657609 0 108.182692 48.526106 108.182692 108.182692 0 59.628956-48.525083 108.197018-108.182692 108.197018z m543.386785-155.934157c-59.684215 0-108.210321-48.553735-108.210321-108.183715 0-59.656586 48.526106-108.210321 108.210321-108.210321 59.657609 0 108.155063 48.553735 108.155063 108.210321 0.001023 59.62998-48.497454 108.183715-108.155063 108.183715z" fill="#ffffff" p-id="12443"></path><path d="M828.471136 668.953368c-11.610409 0-21.05039 9.439981-21.05039 21.063692 0 13.062478-10.652596 23.728377-23.728377 23.728377-13.10341 0-23.754983-10.665899-23.754982-23.728377 0-8.482168 4.591566-16.371843 11.948099-20.626741 10.060103-5.790878 13.526034-18.683487 7.749482-28.75894-5.805204-10.044754-18.683487-13.497382-28.772243-7.735156-20.372962 11.737299-33.026118 33.632938-33.026118 57.119814 0 36.309901 29.532558 65.829156 65.855762 65.829156 36.296598 0 65.856785-29.519255 65.856786-65.829156 0.001023-11.622689-9.439981-21.062669-21.078019-21.062669zM285.083327 821.661046c-11.609386 0-21.049366 9.398025-21.049366 21.049367 0 13.07578-10.623944 23.74168-23.728377 23.74168-13.089083 0-23.740656-10.665899-23.740656-23.74168 0-8.496494 4.579286-16.386169 11.933773-20.613439 10.074429-5.833857 13.526034-18.69679 7.736179-28.757917-5.819531-10.087732-18.684511-13.540361-28.75894-7.736179-20.359659 11.737299-33.012815 33.618611-33.012815 57.106512 0 36.309901 29.519255 65.842459 65.842459 65.842459 36.309901 0 65.828133-29.531535 65.828133-65.842459 0.001023-11.651341-9.411328-21.048343-21.05039-21.048344z" fill="#ffffff" p-id="12444"></path></svg>'
SVGImg = '<svg t="1734836550884" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1591" width="200" height="200"><path d="M607.9 707.9l-47.5 45.9c-14.6 14.1-33.9 21.9-54.2 21.9s-39.6-7.8-54.2-21.9L311.4 618c-8.6-8.3-22-8.3-30.6 0l-217 209.4c7.8 74.4 70.8 132.5 147.2 132.5h598.5c29.7 0 57.3-8.8 80.5-23.9L655.2 707.8c-13.2-12.7-34-12.7-47.3 0.1zM666.1 276.3c-49.3 0-89.5 40.1-89.5 89.5s40.1 89.5 89.5 89.5c49.3 0 89.5-40.1 89.5-89.5s-40.2-89.5-89.5-89.5z" fill="#ffffff" p-id="1592"></path><path d="M809.6 65.4H211c-81.6 0-148 66.4-148 148v537l179-172.7c14.6-14.1 33.9-21.9 54.2-21.9s39.6 7.8 54.2 21.9L491 713.5c8.6 8.3 22 8.3 30.6 0l47.5-45.9c16.9-16.3 39.1-25.3 62.6-25.3s45.7 9 62.6 25.3l236.3 229.6c17.1-24.1 27.1-53.6 27.1-85.3V213.4c-0.1-81.6-66.5-148-148.1-148zM666.1 511.3c-80.2 0-145.5-65.3-145.5-145.5s65.3-145.5 145.5-145.5 145.5 65.3 145.5 145.5-65.3 145.5-145.5 145.5z" fill="#ffffff" p-id="1593"></path></svg>'

const mainBox = document.getElementById('mainbox')
let UploadFilesInputE,ExtraText,filesDialog,fileOption,folderOption
let Euploadbutton

let files
let filesURL = []
let CoverURL = []
let fileNames = [] 
let CoverNames = [] 
let CoverIndex = [] 
let coverIndexArr = []
//test
// filesURL = new Array(5).fill('test');
// coverIndexArr = [0,2,4];
// CoverURL = ['cover1.jpg', 'cover2.jpg', 'cover3.jpg'];

document.getElementById('fileButton').innerHTML = SVGMusic
document.getElementById('coverButton').innerHTML = SVGImg

document.getElementById('fileButton').addEventListener('click',function(){
    Upload('music')
    })
document.getElementById('coverButton').addEventListener('click',function(){
    Upload('cover')
})


    function Upload(s) {
    const dialogBox = document.createElement('dialog')
    dialogBox.id = 'fileDialog'
    mainBox.appendChild(dialogBox)
    filesDialog = document.getElementById('fileDialog')
    // 输入文件的input .EfileInput
    const Einput = document.createElement('input')
    Einput.setAttribute('class', 'EfileInput')
    Einput.type = 'file'
    Einput.multiple = true
    Einput.webkitdirectory = false
    Einput.accept = 'audio/*,file/*'
    
    if(s == 'cover'){
        Einput.accept = 'image/*,file/*'
    }


    //触发上传事件 .Euploadbutton
    Euploadbutton = document.createElement('button')
    Euploadbutton.textContent = '添加音乐'
    if(s == 'cover'){
        Euploadbutton.textContent = '添加封面'
    }
    Euploadbutton.setAttribute('class', 'Euploadbutton')
    Euploadbutton.addEventListener('click',()=>{
        Euploadbutton = document.getElementsByClassName('Euploadbutton')[0]
        Einput.click()
    })
    //全屏弹窗.EfullButton
    let EfullButton = document.createElement('button')
    EfullButton.innerHTML = SVGFullScreen
    EfullButton.setAttribute('class', 'EfullButton')
    EfullButton.addEventListener('click',()=>{
        //本来是存在createElement('div')的 但是这里要修改已创建元素的属性 
        //用getElementsByClassName再次锁定创建后的自己
        EfullButton = document.getElementsByClassName('EfullButton')[0]
        // console.log(EfullButton)
        if(filesDialog.getAttribute('full') === null){
            filesDialog.setAttribute('full', true)
            EfullButton.innerHTML = SVGDisFullScreen
        }else{
            filesDialog.removeAttribute('full')
            EfullButton.innerHTML = SVGFullScreen
       }
    })
    filesDialog.appendChild(EfullButton)
    //关闭弹窗
    const Ecancelbutton = document.createElement('button')
    Ecancelbutton.innerHTML = SVGCancle
    Ecancelbutton.addEventListener('click',()=>{
        filesDialog.close()
        filesDialog.remove()
    })
    Ecancelbutton.setAttribute('class', 'Ecancelbutton')
    // 注释
    ExtraText = document.createElement('div')
    ExtraText.setAttribute('tip', true)
    ExtraText.innerHTML = `
            <p>此页面用于上传音乐文件</p>
            <p>请选择音乐<span id="fileOption">文件</span>或<span id="folderOption">文件夹</span></p>
            <p>第一行为原文件名 第二行请输入需要显示的曲名</p>
            <p>第三行为作曲家或专辑等附加短内容</p>
            <p>文件名不同于播放器中显示名 不互相影响 不用担心</p>`
    if(s == 'cover'){
        ExtraText.innerHTML = `
            <p>此页面用于上传封面文件</p>
            <p>请选择音乐<span id="fileOption">文件</span>或<span id="folderOption">文件夹</span></p>
            <p>显示的为原文件名</p>
            <p>输入的是曲目的索引号(index)</p>
            <p>白话就是第几个 但是从0开始数01234...</p>
            <p>具体索引号可按照左侧已添加曲目列表数</p>`
    }


    filesDialog.showModal()
    filesDialog.appendChild(Einput)
    filesDialog.appendChild(Euploadbutton)
    filesDialog.appendChild(Ecancelbutton)
    filesDialog.appendChild(ExtraText)

    //tip中的选项选择
    folderOption = document.getElementById('folderOption')
    fileOption = document.getElementById('fileOption')
    //初始值:文件
    fileOption.setAttribute('selected', true)
    //切换文件或文件夹
    folderOption.addEventListener('click',()=>{
        if(UploadFilesInputE.webkitdirectory === true){
            return
        }
        UploadFilesInputE.webkitdirectory = true
        fileOption.removeAttribute('selected')
        folderOption.setAttribute('selected', true)
    })
    fileOption.addEventListener('click',()=>{
        if(UploadFilesInputE.webkitdirectory === false){
            return
        }
        UploadFilesInputE.webkitdirectory = false
        fileOption.setAttribute('selected', true)
        folderOption.removeAttribute('selected')
    })

    UploadFilesInputE = document.getElementsByClassName('EfileInput')[0]
    UploadFilesInputE.addEventListener('change', function() {
        filesFunction(s)
    }
)

}



function filesFunction(s) {
//[上传音乐/上传封面]
    files = UploadFilesInputE.files
    // console.log(files)
    if(s == 'music'){
        fileNames = [] 
        for(let i=0;i<files.length;i++){
            fileNames.push(files[i].name)
            filesURL.push(URL.createObjectURL(files[i]))
        }
    }
    if(s == 'cover'){
        CoverNames = []
        CoverURL = [] //锚点12/23/2024/11:51PM
        for(let i=0;i<files.length;i++){
            // console.log(files[i])
            // console.log(files[i].name)
            CoverNames.push(files[i].name)
            CoverURL.push(URL.createObjectURL(files[i]))
        }
    }

    console.log(filesURL)
    
    // console.log(fileNames)
    // let index = 0
    // console.log(fileNames)
    // let index = 0
    // console.log(files.length)
    
    Euploadbutton.setAttribute('reset', true)
    Euploadbutton.textContent = '再次添加'
    if(document.getElementsByClassName('renameButton').length>0){
        document.getElementsByClassName('renameButton')[0].remove()
    }   
    const fileEditBox = document.createElement('div')
    filesDialog.appendChild(fileEditBox)
    fileEditBox.setAttribute('editor', true)
if(s == 'music'){
    for(let index=0;index<files.length;index++){
        var filechild = document.createElement('span')
        var filechildName = document.createElement('span')
        var filechildRenamed = document.createElement('input')
        var filechildRenamedSub = document.createElement('input')


        filechildName.textContent = fileNames[index]
        filechildName.setAttribute('index', index)

        filechildRenamed.type = 'text'
        filechildRenamed.value = (fileNames[index].replace(/\.[^/.]+$/, ''))
        filechildRenamed.setAttribute('index', index)

        filechildRenamedSub.type = 'text'
        filechildRenamedSub.value = (fileNames[index].replace(/\.[^/.]+$/, ''))
        filechildRenamedSub.setAttribute('index', index)
        
        filechild.setAttribute('class', 'musicFileList')

        filechild.appendChild(filechildName)
        filechild.appendChild(filechildRenamed)
        filechild.appendChild(filechildRenamedSub)
        fileEditBox.appendChild(filechild)
    }
}
if(s == 'cover'){
    for(let index=0;index<files.length;index++){
        var Coverchild = document.createElement('span')
        var CoverchildName = document.createElement('span')
        var CoverchildIndex = document.createElement('input')


        CoverchildName.textContent = CoverNames[index]

        // console.log(CoverNames[index])

        CoverchildIndex.type = 'text'
        CoverchildIndex.setAttribute('class', 'coverIndex')
        // CoverchildIndex.value = index

        Coverchild.setAttribute('class', 'coverFileList')

        Coverchild.appendChild(CoverchildName)
        Coverchild.appendChild(CoverchildIndex)
        fileEditBox.appendChild(Coverchild)
    }
}
    var fileRenameButton = document.createElement('button')
    fileRenameButton.innerHTML = SVGOK
    fileRenameButton.setAttribute('class','renameButton')
    fileEditBox.appendChild(fileRenameButton)
    fileRenameButton = document.getElementsByClassName('renameButton')[0]
    fileRenameButton.addEventListener('click',function() {
        if(s == 'music'){
        getMusicInfo()
        }
        if(s == 'cover'){
            getCoverInfo()
        }
    })
}
let musicTitleArr = []
let musicArtistArr = []
let musicFileList = document.getElementsByClassName('musicFileList')


// console.log(musicTitleArr)
// console.log(musicArtistArr)
function getMusicInfo() {
    for(i=0;i<musicFileList.length;i++){
        musicTitleArr.push(musicFileList[i].children[1].value)//获得用户设置的曲名
        musicArtistArr.push(musicFileList[i].children[2].value)//获得用户设置的歌手名
    }    
    // console.log(musicTitleArr)
    // console.log(musicArtistArr)
    filesDialog.close()
    filesDialog.remove()
    const EmusicList = document.getElementById('musicList')
    EmusicList.innerHTML = ''
    for(let i=0;i<musicTitleArr.length;i++){
        let EmusicChild = document.createElement('span')
        EmusicChild.setAttribute('class','musicListChild')
        EmusicChild.setAttribute('data-index', i )

        let EmusicArtistArr = document.createElement('span')
        EmusicArtistArr.setAttribute('class','musicListChildArtist')

        let EmusicTitleArr = document.createElement('span')
        EmusicTitleArr.setAttribute('class','musicListChildTitle')
        EmusicChild.appendChild(EmusicTitleArr)
        EmusicChild.appendChild(EmusicArtistArr)
        EmusicList.appendChild(EmusicChild)
        let EmusicListTiTle = document.getElementsByClassName('musicListChildTitle')
        let EmusicListArtist = document.getElementsByClassName('musicListChildArtist')
        EmusicListArtist[i].innerHTML = musicArtistArr[i]
        EmusicListTiTle[i].innerHTML = musicTitleArr[i]
        

    }
    buzhidaomingzisuibianba()
    
}
let coverFilesArr = []
let CoverFileList = document.getElementsByClassName('coverFileList')
function getCoverInfo() {
    //获得input中的值加入coverIndexArr
    coverIndexArr = []
    for(let i=0;i<CoverFileList.length;i++){
        coverIndexArr.push(document.getElementsByClassName('coverIndex')[i].value)
    }

//在控制台里基本测试正常
//问题应该在传文件到这中途被归零
// console.log(filesURL)//音乐文件URL组
console.log(coverIndexArr)//封面索引组 //问题前面获得数据//解决
console.log(CoverURL)//封面文件URL组
//[Q]每次上传会重置 coverFilesArr  
//===P-A
//让每次上传重置结果
// CoverURL = [] =>在上传部分添加重置 ==>//锚点12/23/2024/11:51PM [临时 :161]
////此方案问题解决
//===P-B --优化方案
// 解决逻辑=>加一个originCoverFilesArr 存储前一个结果
//              先判断是否存在originCoverFilesArr 如果无 直接创建coverFilesArr
//              创建后存在originCoverFilesArr
//              如果有 在获得新的coverFilesArr后把其中每个结果判断 
//             先判断originCoverFilesArr和coverFilesArr的长度是否一致
//             始终用coverFilesArr的长度作为结果
//                如果有新的就用coverFilesArr覆盖originCoverFilesArr
//                如果没有新的就用originCoverFilesArr覆盖coverFilesArr的null
//               如果是null就不用管或覆盖为null
//               如果长度中不存在此索引 ==>会返回undefined  如果为undefined 覆盖为null
//               --[待修改]--
coverFilesArr = new Array(filesURL.length).fill(null); // 假设最终数组长度为曲目长度
for (let i = 0; i < coverIndexArr.length; i++) {
    let index = coverIndexArr[i]; // 获取当前的索引值
    if (index < filesURL.length) { // 确保索引在有效范围内
        coverFilesArr[index] = CoverURL[i]; // 将文件放入对应索引位置
}else{
    error('封面索引超出范围')
}}


    console.log(coverFilesArr)
    // coverIndexArr = []

    filesDialog.close()
    filesDialog.remove()
    let active = document.getElementById('active')
    if(active == null){
        return
    }
    let i = active.getAttribute('data-index')
    document.getElementById('CD').children[0].src = coverFilesArr[i]
}
// function test(){
//     if(document.getElementById('active') != null){
//         alert('123')
//         choseMusic(music[0])
//         musicAudio.pause()
//     }
// }
